!function(){
  const e=document.getElementById("bgCanvas"),
        t=e&&e.getContext?e.getContext("2d"):null,
        n={w:0,h:0,particles:[]};

  function r(){if(!t)return;n.w=e.width=window.innerWidth,n.h=e.height=window.innerHeight}
  function a(e,t){return Math.random()*(t-e)+e}
  function i(n){let r=[];for(let e=0;e<80;e++)r.push({x:a(0,n.w),y:a(0,n.h),r:a(.7,2.4),vx:a(-.15,.15),vy:a(-.02,.02),alpha:a(.05,.35)});return r}
  function l(){
    if(!t)return;
    t.clearRect(0,0,n.w,n.h);
    const e=t.createRadialGradient(.75*n.w,.2*n.h,100,.6*n.w,.2*n.h,Math.max(n.w,n.h));
    e.addColorStop(0,"rgba(120,90,180,0.06)"),e.addColorStop(1,"rgba(0,0,0,0)"),
    t.fillStyle=e,t.fillRect(0,0,n.w,n.h);
    for(let e of n.particles)
      e.x+=e.vx,e.y+=e.vy,
      e.x<-50&&(e.x=n.w+50),e.x>n.w+50&&(e.x=-50),
      e.y<-50&&(e.y=n.h+50),e.y>n.h+50&&(e.y=-50),
      t.beginPath(),t.fillStyle="rgba(255,255,255,"+e.alpha+")",
      t.arc(e.x,e.y,e.r,0,2*Math.PI),t.fill();
    requestAnimationFrame(l)
  }

  function s(){
    const e=new IntersectionObserver(t=>{
      t.forEach(t=>{t.isIntersecting&&t.target.classList.add("show")})
    },{threshold:.15});
    document.querySelectorAll(".panel-inner,.stat,.vision-art,.milestone").forEach(t=>e.observe(t))
  }

  function c(){
    const e=document.getElementById("ctaPrereg");
    e&&setInterval(()=>e.animate([{transform:"scale(1)"},{transform:"scale(.98)"},{transform:"scale(1)"}],{duration:3e3,easing:"ease-in-out"}),3300)
  }

  function u(){
    document.querySelectorAll(".number").forEach(e=>{
      let t=0,n=parseInt(e.dataset.target),r=Math.ceil(n/120);
      !function a(){t+=r,t>n&&(t=n),e.textContent=t.toLocaleString(),t<n&&requestAnimationFrame(a)}()
    })
  }

  function d(){r(),n.particles=i(n),l(),s(),c(),u()}
  window.addEventListener("resize",()=>{r(),n.particles=i(n)}),
  document.addEventListener("DOMContentLoaded",d)
}();