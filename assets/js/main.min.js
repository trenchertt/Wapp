!function(){
  const e=document.getElementById("bgCanvas"),
        t=e&&e.getContext?e.getContext("2d"):null,
        n={w:0,h:0,particles:[]};

  function resize(){if(!t)return;n.w=e.width=window.innerWidth,n.h=e.height=window.innerHeight}
  function rand(a,b){return Math.random()*(b-a)+a}
  function createParticles(n){n=[];for(let t=0;t<80;t++)n.push({x:rand(0,window.innerWidth),y:rand(0,window.innerHeight),r:rand(.7,2.4),vx:rand(-.15,.15),vy:rand(-.02,.02),alpha:rand(.05,.35)});return n}
  function draw(){
    if(!t)return;
    t.clearRect(0,0,n.w,n.h);
    const g=t.createRadialGradient(.75*n.w,.2*n.h,100,.6*n.w,.2*n.h,Math.max(n.w,n.h));
    g.addColorStop(0,"rgba(120,90,180,0.06)"),g.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=g,t.fillRect(0,0,n.w,n.h);
    for(let p of n.particles)p.x+=p.vx,p.y+=p.vy,p.x<-50&&(p.x=n.w+50),p.x>n.w+50&&(p.x=-50),p.y<-50&&(p.y=n.h+50),p.y>n.h+50&&(p.y=-50),t.beginPath(),t.fillStyle="rgba(255,255,255,"+p.alpha+")",t.arc(p.x,p.y,p.r,0,2*Math.PI),t.fill();
    requestAnimationFrame(draw)
  }
  function tilt(){document.querySelectorAll(".interactive[data-tilt]").forEach(t=>{
    t.addEventListener("mousemove",e=>{
      const r=t.getBoundingClientRect(),a=(e.clientX-r.left)/r.width-0.5,i=(e.clientY-r.top)/r.height-0.5;
      t.style.transform=`perspective(700px) translateY(-6px) rotateX(${(-i*6).toFixed(2)}deg) rotateY(${(a*6).toFixed(2)}deg) scale(1.02)`
    }),
        t.addEventListener("mouseleave",()=>{t.style.transform=""})
  })}
  
  function fadeIn(){ 
    const observer=new IntersectionObserver(entries=>{
      entries.forEach(e=>{
        if(e.isIntersecting){
          e.target.style.opacity=1;
          e.target.style.transform="translateY(0)";
        }
      })
    },{threshold:.12});
    
    document.querySelectorAll(".panel-inner,.card,.principle,.step,.team-member").forEach(e=>observer.observe(e))
  }

  function ctaAnim(){
    const e=document.querySelector(".cta .btn-full");
    if(e) setInterval(()=>e.animate([{transform:"scale(1)"},{transform:"scale(1.05)"},{transform:"scale(1)"}],
      {duration:3000,easing:"ease-in-out"}),3300)
  }

  function init(){
    resize();
    n.particles=createParticles(Math.max(60,Math.floor(window.innerWidth/18)));
    draw();
    tilt();
    fadeIn();
    ctaAnim();
  }

  window.addEventListener("resize",()=>{
    resize();
    n.particles=createParticles(Math.max(60,Math.floor(window.innerWidth/18)));
  });

  document.addEventListener("DOMContentLoaded",init);
}();
